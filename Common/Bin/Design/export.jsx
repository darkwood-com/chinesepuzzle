// enable double clicking from the Macintosh Finder or the Windows Explorer#target photoshop// in case we double clicked the fileapp.bringToFront();// debug level: 0-2 (0:disable, 1:break on error, 2:break at beginning)//$.level = 2;//debugger; // launch debugger on next linefunction createRect(x, y, width, height){    return new Array(new Array(x,y), new Array(x + width, y), new Array(x + width, y + height), new Array(x, y + height));}function max(a, b){    return a > b ? a : b;}function midPoint(point){    point.to = [        point.to[0] - point.from[2] / 2,        point.to[1] - point.from[3] / 2    ];    return point;}function zeroPoint(point){    point.to = [0, 0];    return point;}function spriteSize(sprite){    var width = 0;    var height = 0;        for(zoneIt in sprite)    {        var zone = sprite[zoneIt];        width = max(zone["from"][2] + zone["to"][0], width);        height = max(zone["from"][3] + zone["to"][1], height);    }    return {"width":width, "height":height};}function spriteCopy(sprite, spriteSrcDoc, spriteDestDoc){    for(zoneIt in sprite)    {        var zone = sprite[zoneIt];        app.activeDocument = spriteSrcDoc;        spriteSrcDoc.selection.select(createRect(zone["from"][0],zone["from"][1],zone["from"][2],zone["from"][3]));        spriteSrcDoc.selection.copy();                app.activeDocument = spriteDestDoc;        spriteDestDoc.selection.select(createRect(zone["to"][0],zone["to"][1],zone["from"][2],zone["from"][3]));        spriteDestDoc.paste(true);    }}//configvar exportmode = "texturepacker"; //debug or release or texturepackervar datadir = "/Users/math/Mathieu/Programmation/Programmation/ChinesePuzzle/Common/Bin/";var themes = ["chinese","circle","classic","polkadots","seamless","shullshearts","splash","spring","stripes","vivid"];var resolutions = {    "480x320":{         "ui":{            "menuMask":[{from:[0,0,480,320], to:[0,0]}],            "menuContainer":[{from:[480,0,96,96], to:[0,0]}],            "menuItemYes":[{from:[480,96,84,28], to:[0,0]}],            "menuItemNo":[{from:[480,139,84,28], to:[0,0]}],            "menuItemOk":[{from:[480,183,36,36], to:[0,0]}],            "menuItemThemeClassic":[{from:[480,230,90,72], to:[0,0]}],        },        "theme":{            "bg":[{from:[0,0,480,320], to:[0,0]}],            "cardplaybg":[{from:[528,0,26,36], to:[0,0]}],            "cardboardempty":[{from:[576,0,26,36], to:[0,0]}],            "cardboardyes":[{from:[624,0,26,36], to:[0,0]}],            "cardboardno":[{from:[672,0,26,36], to:[0,0]}],            "cardtouched":[{from:[720,0,26,36], to:[0,0]}],            "newBtn":[{from:[480,158,36,36], to:[0,0]}],            "retryBtn":[{from:[528,158,36,36], to:[0,0]}],            "hintBtn":[{from:[576,158,36,36], to:[0,0]}],            "soundOnBtn":[{from:[624,158,36,36], to:[0,0]}],            "soundOffBtn":[{from:[624,208,36,36], to:[0,0]}],            "themeBtn":[{from:[672,158,36,36], to:[0,0]}],            "undoBtn":[{from:[720,158,36,36], to:[0,0]}],        },        "card":function(colorIndex, rankIndex) {            var txtColorLine = [53,73,93,112];            var txtRankLine = [516,8,526,7,535,7,544,7,553,7,562,7,571,7,580,7,589,7,597,9,608,7,616,10,627,7];            var shapeColorBig = [[480,52,15,16],[481,70,12,17],[480,90,14,17],[480,110,16,16]];            var shapeColorSmall = [[501,54,9,10],[502,74,8,10],[502,93,9,10],[501,113,10,10]];                        return {                "cardbg":{from:[480,0,26,36], to:[0,0]},                "rankleft":midPoint({from:[txtRankLine[rankIndex*2],txtColorLine[colorIndex],txtRankLine[rankIndex*2+1],13], to:[8,9]}),                "colorcenter":midPoint({from:shapeColorBig[colorIndex], to:[13,25]}),                "colorright":midPoint({from:shapeColorSmall[colorIndex], to:[18,9]}),            };        }    },    "960x640":{         "ui":{            "menuMask":[{from:[0,0,960,640], to:[0,0]}],            "menuContainer":[{from:[960,0,192,192], to:[0,0]}],            "menuItemYes":[{from:[960,192,100,36], to:[0,0]}],            "menuItemNo":[{from:[960,278,100,36], to:[0,0]}],            "menuItemOk":[{from:[960,366,72,72], to:[0,0]}],            "menuItemThemeClassic":[{from:[960,460,180,144], to:[0,0]}],        },        "theme":{            "bg":[{from:[0,0,960,640], to:[0,0]}],            "cardplaybg":[{from:[1056,0,52,72], to:[0,0]}],            "cardboardempty":[{from:[1152,0,52,72], to:[0,0]}],            "cardboardyes":[{from:[1248,0,52,72], to:[0,0]}],            "cardboardno":[{from:[1344,0,52,72], to:[0,0]}],            "cardtouched":[{from:[1440,0,52,72], to:[0,0]}],            "newBtn":[{from:[960,316,72,72], to:[0,0]}],            "retryBtn":[{from:[1056,316,72,72], to:[0,0]}],            "hintBtn":[{from:[1152,316,72,72], to:[0,0]}],            "soundOnBtn":[{from:[1248,316,72,72], to:[0,0]}],            "soundOffBtn":[{from:[1248,416,72,72], to:[0,0]}],            "themeBtn":[{from:[1344,316,72,72], to:[0,0]}],            "undoBtn":[{from:[1440,316,72,72], to:[0,0]}],        },        "card":function(colorIndex, rankIndex) {            var txtColorLine = [106,146,186,224];            var txtRankLine = [1032,16,1052,14,1070,14,1088,14,1106,14,1124,14,1142,14,1160,14,1178,14,1194,18,1216,14,1232,20,1254,14];            var shapeColorBig = [[960,104,30,32],[962,140,24,34],[960,180,28,34],[960,220,32,32]];            var shapeColorSmall = [[1002,108,18,20],[1004,148,16,20],[1004,186,18,20],[1002,226,20,20]];                        return {                "cardbg":{from:[960,0,52,72], to:[0,0]},                "rankleft":midPoint({from:[txtRankLine[rankIndex*2],txtColorLine[colorIndex],txtRankLine[rankIndex*2+1],26], to:[16,18]}),                "colorcenter":midPoint({from:shapeColorBig[colorIndex], to:[26,50]}),                "colorright":midPoint({from:shapeColorSmall[colorIndex], to:[36,18]}),            };        }    },    "1024x768":{        "ui":{            "menuMask":[{from:[0,0,1024,768], to:[0,0]}],            "menuContainer":[{from:[1024,0,192,192], to:[0,0]}],            "menuItemYes":[{from:[1024,192,84,28], to:[0,0]}],            "menuItemNo":[{from:[1024,222,84,28], to:[0,0]}],            "menuItemOk":[{from:[1024,257,55,55], to:[0,0]}],            "menuItemThemeClassic":[{from:[1024,320,195,156], to:[0,0]}],        },        "theme":{            "bg":[{from:[0,0,1024,768], to:[0,0]}],            "cardplaybg":[{from:[1100,0,56,78], to:[0,0]}],            "cardboardempty":[{from:[1176,0,56,78], to:[0,0]}],            "cardboardyes":[{from:[1252,0,56,78], to:[0,0]}],            "cardboardno":[{from:[1328,0,56,78], to:[0,0]}],            "cardtouched":[{from:[1404,0,56,78], to:[0,0]}],            "newBtn":[{from:[1024,380,56,56], to:[0,0]}],            "retryBtn":[{from:[1100,380,56,56], to:[0,0]}],            "hintBtn":[{from:[1176,380,56,56], to:[0,0]}],            "soundOnBtn":[{from:[1252,380,56,56], to:[0,0]}],            "soundOffBtn":[{from:[1252,451,56,56], to:[0,0]}],            "themeBtn":[{from:[1328,380,56,56], to:[0,0]}],            "undoBtn":[{from:[1404,380,56,56], to:[0,0]}],        },        "card":function(colorIndex, rankIndex) {            var txtColorLine = [143,185,231,273];            var txtRankLine = [1102,18,1123,14,1143,14,1162,15,1183,15,1203,14,1223,14,1243,14,1263,14,1281,20,1304,14,1320,21,1343,15];            var shapeColorBig = [[1024,140,31,34],[1027,181,26,36],[1025,224,30,36],[1024,267,34,34]];            var shapeColorSmall = [[1071,146,19,21],[1073,189,16,22],[1072,231,18,22],[1070,274,21,21]];                        return {                "cardbg":{from:[1024,0,56,78], to:[0,0]},                "rankleft":midPoint({from:[txtRankLine[rankIndex*2],txtColorLine[colorIndex],txtRankLine[rankIndex*2+1],27], to:[17,20]}),                "colorcenter":midPoint({from:shapeColorBig[colorIndex], to:[28,54]}),                "colorright":midPoint({from:shapeColorSmall[colorIndex], to:[39,20]}),            };        }    },    "1280x800":{        "ui":{            "menuMask":[{from:[0,0,1280,800], to:[0,0]}],            "menuContainer":[{from:[1280,0,192,192], to:[0,0]}],            "menuItemYes":[{from:[1280,192,84,28], to:[0,0]}],            "menuItemNo":[{from:[1280,222,84,28], to:[0,0]}],            "menuItemOk":[{from:[1280,257,55,55], to:[0,0]}],            "menuItemThemeClassic":[{from:[1280,320,195,156], to:[0,0]}],        },        "theme":{            "bg":[{from:[0,0,1280,800], to:[0,0]}],            "cardplaybg":[{from:[1356,0,56,78], to:[0,0]}],            "cardboardempty":[{from:[1432,0,56,78], to:[0,0]}],            "cardboardyes":[{from:[1508,0,56,78], to:[0,0]}],            "cardboardno":[{from:[1584,0,56,78], to:[0,0]}],            "cardtouched":[{from:[1660,0,56,78], to:[0,0]}],            "newBtn":[{from:[1280,380,56,56], to:[0,0]}],            "retryBtn":[{from:[1356,380,56,56], to:[0,0]}],            "hintBtn":[{from:[1432,380,56,56], to:[0,0]}],            "soundOnBtn":[{from:[1508,380,56,56], to:[0,0]}],            "soundOffBtn":[{from:[1508,451,56,56], to:[0,0]}],            "themeBtn":[{from:[1584,380,56,56], to:[0,0]}],            "undoBtn":[{from:[1660,380,56,56], to:[0,0]}],        },        "card":function(colorIndex, rankIndex) {            var txtColorLine = [143,185,231,273];            var txtRankLine = [1358,18,1379,14,1399,14,1418,15,1439,15,1459,14,1479,14,1499,14,1519,14,1537,20,1560,14,1576,21,1599,15];            var shapeColorBig = [[1280,140,31,34],[1283,181,26,36],[1281,224,30,36],[1280,267,34,34]];            var shapeColorSmall = [[1327,146,19,21],[1329,189,16,22],[1328,231,18,22],[1326,274,21,21]];                        return {                "cardbg":{from:[1280,0,56,78], to:[0,0]},                "rankleft":midPoint({from:[txtRankLine[rankIndex*2],txtColorLine[colorIndex],txtRankLine[rankIndex*2+1],27], to:[17,20]}),                "colorcenter":midPoint({from:shapeColorBig[colorIndex], to:[28,54]}),                "colorright":midPoint({from:shapeColorSmall[colorIndex], to:[39,20]}),            };        }    },    "1280x1024":{        "ui":{            "menuMask":[{from:[0,0,1280,1024], to:[0,0]}],            "menuContainer":[{from:[1280,0,192,192], to:[0,0]}],            "menuItemYes":[{from:[1280,192,96,32], to:[0,0]}],            "menuItemNo":[{from:[1280,235,96,32], to:[0,0]}],            "menuItemOk":[{from:[1280,279,64,64], to:[0,0]}],            "menuItemThemeClassic":[{from:[1280,360,228,182], to:[0,0]}],        },        "theme":{            "bg":[{from:[0,0,1280,1024], to:[0,0]}],            "cardplaybg":[{from:[1358,0,66,92], to:[0,0]}],            "cardboardempty":[{from:[1436,0,66,92], to:[0,0]}],            "cardboardyes":[{from:[1514,0,66,92], to:[0,0]}],            "cardboardno":[{from:[1592,0,66,92], to:[0,0]}],            "cardtouched":[{from:[1670,0,66,92], to:[0,0]}],            "newBtn":[{from:[1280,400,64,64], to:[0,0]}],            "retryBtn":[{from:[1358,400,64,64], to:[0,0]}],            "hintBtn":[{from:[1436,400,64,64], to:[0,0]}],            "soundOnBtn":[{from:[1514,400,64,64], to:[0,0]}],            "soundOffBtn":[{from:[1514,480,64,64], to:[0,0]}],            "themeBtn":[{from:[1592,400,64,64], to:[0,0]}],            "undoBtn":[{from:[1670,400,64,64], to:[0,0]}],        },        "card":function(colorIndex, rankIndex) {            var txtColorLine = [145,194,246,296];            var txtRankLine = [1370,20,1395,16,1418,16,1441,18,1464,17,1488,16,1512,16,1536,16,1559,16,1580,23,1608,16,1627,24,1655,17];            var shapeColorBig = [[1280,142,37,40],[1284,190,31,42],[1282,239,35,42],[1280,290,40,40]];            var shapeColorSmall = [[1336,149,22,24],[1336,198,19,26],[1336,248,21,26],[1334,298,24,24]];                        return {                "cardbg":{from:[1280,0,66,92], to:[0,0]},                "rankleft":midPoint({from:[txtRankLine[rankIndex*2],txtColorLine[colorIndex],txtRankLine[rankIndex*2+1],31], to:[18,24]}),                "colorcenter":midPoint({from:shapeColorBig[colorIndex], to:[32,64]}),                "colorright":midPoint({from:shapeColorSmall[colorIndex], to:[46,24]}),            };        }    },    "1366x768":{        "ui":{            "menuMask":[{from:[0,0,1366,768], to:[0,0]}],            "menuContainer":[{from:[1366,0,192,192], to:[0,0]}],            "menuItemYes":[{from:[1366,192,84,28], to:[0,0]}],            "menuItemNo":[{from:[1366,222,84,28], to:[0,0]}],            "menuItemOk":[{from:[1366,257,55,55], to:[0,0]}],            "menuItemThemeClassic":[{from:[1366,320,195,156], to:[0,0]}],        },        "theme":{            "bg":[{from:[0,0,1366,768], to:[0,0]}],            "cardplaybg":[{from:[1442,0,56,78], to:[0,0]}],            "cardboardempty":[{from:[1518,0,56,78], to:[0,0]}],            "cardboardyes":[{from:[1594,0,56,78], to:[0,0]}],            "cardboardno":[{from:[1670,0,56,78], to:[0,0]}],            "cardtouched":[{from:[1746,0,56,78], to:[0,0]}],            "newBtn":[{from:[1366,380,56,56], to:[0,0]}],            "retryBtn":[{from:[1442,380,56,56], to:[0,0]}],            "hintBtn":[{from:[1518,380,56,56], to:[0,0]}],            "soundOnBtn":[{from:[1594,380,56,56], to:[0,0]}],            "soundOffBtn":[{from:[1594,451,56,56], to:[0,0]}],            "themeBtn":[{from:[1670,380,56,56], to:[0,0]}],            "undoBtn":[{from:[1746,380,56,56], to:[0,0]}],        },        "card":function(colorIndex, rankIndex) {            var txtColorLine = [143,185,231,273];            var txtRankLine = [1444,18,1465,14,1485,14,1504,15,1525,15,1545,14,1565,14,1585,14,1605,14,1623,20,1646,14,1662,21,1685,15];            var shapeColorBig = [[1366,140,31,34],[1369,181,26,36],[1367,224,30,36],[1366,267,34,34]];            var shapeColorSmall = [[1413,146,19,21],[1415,189,16,22],[1414,231,18,22],[1412,274,21,21]];                        return {                "cardbg":{from:[1366,0,56,78], to:[0,0]},                "rankleft":midPoint({from:[txtRankLine[rankIndex*2],txtColorLine[colorIndex],txtRankLine[rankIndex*2+1],27], to:[17,20]}),                "colorcenter":midPoint({from:shapeColorBig[colorIndex], to:[28,54]}),                "colorright":midPoint({from:shapeColorSmall[colorIndex], to:[39,20]}),            };        }    },    "1440x900":{        "ui":{            "menuMask":[{from:[0,0,1440,900], to:[0,0]}],            "menuContainer":[{from:[1440,0,192,192], to:[0,0]}],            "menuItemYes":[{from:[1440,192,96,32], to:[0,0]}],            "menuItemNo":[{from:[1440,235,96,32], to:[0,0]}],            "menuItemOk":[{from:[1440,279,64,64], to:[0,0]}],            "menuItemThemeClassic":[{from:[1440,360,228,182], to:[0,0]}],        },        "theme":{            "bg":[{from:[0,0,1440,900], to:[0,0]}],            "cardplaybg":[{from:[1518,0,66,92], to:[0,0]}],            "cardboardempty":[{from:[1596,0,66,92], to:[0,0]}],            "cardboardyes":[{from:[1674,0,66,92], to:[0,0]}],            "cardboardno":[{from:[1752,0,66,92], to:[0,0]}],            "cardtouched":[{from:[1830,0,66,92], to:[0,0]}],            "newBtn":[{from:[1440,400,64,64], to:[0,0]}],            "retryBtn":[{from:[1518,400,64,64], to:[0,0]}],            "hintBtn":[{from:[1596,400,64,64], to:[0,0]}],            "soundOnBtn":[{from:[1674,400,64,64], to:[0,0]}],            "soundOffBtn":[{from:[1674,480,64,64], to:[0,0]}],            "themeBtn":[{from:[1752,400,64,64], to:[0,0]}],            "undoBtn":[{from:[1830,400,64,64], to:[0,0]}],        },        "card":function(colorIndex, rankIndex) {            var txtColorLine = [145,194,246,296];            var txtRankLine = [1530,20,1555,16,1578,16,1601,18,1624,17,1648,16,1672,16,1696,16,1719,16,1740,23,1768,16,1787,24,1815,17];            var shapeColorBig = [[1440,142,37,40],[1444,190,31,42],[1442,239,35,42],[1440,290,40,40]];            var shapeColorSmall = [[1496,149,22,24],[1496,198,19,26],[1496,248,21,26],[1494,298,24,24]];                        return {                "cardbg":{from:[1440,0,66,92], to:[0,0]},                "rankleft":midPoint({from:[txtRankLine[rankIndex*2],txtColorLine[colorIndex],txtRankLine[rankIndex*2+1],31], to:[18,24]}),                "colorcenter":midPoint({from:shapeColorBig[colorIndex], to:[32,64]}),                "colorright":midPoint({from:shapeColorSmall[colorIndex], to:[46,24]}),            };        }    },    "1680x1050":{        "ui":{            "menuMask":[{from:[0,0,1680,1050], to:[0,0]}],            "menuContainer":[{from:[1680,0,192,192], to:[0,0]}],            "menuItemYes":[{from:[1680,196,107,36], to:[0,0]}],            "menuItemNo":[{from:[1680,235,107,36], to:[0,0]}],            "menuItemOk":[{from:[1680,279,72,72], to:[0,0]}],            "menuItemThemeClassic":[{from:[1680,360,250,200], to:[0,0]}],        },        "theme":{            "bg":[{from:[0,0,1680,1050], to:[0,0]}],            "cardplaybg":[{from:[1760,0,73,100], to:[0,0]}],            "cardboardempty":[{from:[1840,0,73,100], to:[0,0]}],            "cardboardyes":[{from:[1920,0,73,100], to:[0,0]}],            "cardboardno":[{from:[2000,0,73,100], to:[0,0]}],            "cardtouched":[{from:[2080,0,73,100], to:[0,0]}],            "newBtn":[{from:[1680,400,72,72], to:[0,0]}],            "retryBtn":[{from:[1768,400,72,72], to:[0,0]}],            "hintBtn":[{from:[1856,400,72,72], to:[0,0]}],            "soundOnBtn":[{from:[1944,400,72,72], to:[0,0]}],            "soundOffBtn":[{from:[1944,490,72,72], to:[0,0]}],            "themeBtn":[{from:[2032,400,72,72], to:[0,0]}],            "undoBtn":[{from:[2120,400,72,72], to:[0,0]}],        },        "card":function(colorIndex, rankIndex) {            var txtColorLine = [146,200,258,312];            var txtRankLine = [1780,22,1808,17,1833,17,1858,19,1884,18,1910,17,1936,17,1962,17,1987,17,2010,25,2040,17,2060,26,2090,18];            var shapeColorBig = [[1680,142,41,43],[1685,194,35,47],[1682,249,39,46],[1680,305,44,43]];            var shapeColorSmall = [[1741,150,25,26],[1743,204,21,28],[1742,258,24,28],[1740,313,27,26]];                        return {                "cardbg":{from:[1680,0,73,100], to:[0,0]},                "rankleft":midPoint({from:[txtRankLine[rankIndex*2],txtColorLine[colorIndex],txtRankLine[rankIndex*2+1],34], to:[22,24]}),                "colorcenter":midPoint({from:shapeColorBig[colorIndex], to:[36,70]}),                "colorright":midPoint({from:shapeColorSmall[colorIndex], to:[51,24]}),            };        }    },    "1920x1080":{        "ui":{            "menuMask":[{from:[0,0,1920,1080], to:[0,0]}],            "menuContainer":[{from:[1920,0,192,192], to:[0,0]}],            "menuItemYes":[{from:[1920,196,107,36], to:[0,0]}],            "menuItemNo":[{from:[1920,235,107,36], to:[0,0]}],            "menuItemOk":[{from:[1920,279,72,72], to:[0,0]}],            "menuItemThemeClassic":[{from:[1920,360,250,200], to:[0,0]}],        },        "theme":{            "bg":[{from:[0,0,1920,1080], to:[0,0]}],            "cardplaybg":[{from:[2000,0,73,100], to:[0,0]}],            "cardboardempty":[{from:[2080,0,73,100], to:[0,0]}],            "cardboardyes":[{from:[2160,0,73,100], to:[0,0]}],            "cardboardno":[{from:[2240,0,73,100], to:[0,0]}],            "cardtouched":[{from:[2320,0,73,100], to:[0,0]}],            "newBtn":[{from:[1920,400,72,72], to:[0,0]}],            "retryBtn":[{from:[2008,400,72,72], to:[0,0]}],            "hintBtn":[{from:[2096,400,72,72], to:[0,0]}],            "soundOnBtn":[{from:[2184,400,72,72], to:[0,0]}],            "soundOffBtn":[{from:[2184,490,72,72], to:[0,0]}],            "themeBtn":[{from:[2272,400,72,72], to:[0,0]}],            "undoBtn":[{from:[2360,400,72,72], to:[0,0]}],        },        "card":function(colorIndex, rankIndex) {            var txtColorLine = [146,200,258,312];            var txtRankLine = [2020,22,2048,17,2073,17,2098,19,2124,18,2150,17,2176,17,2202,17,2227,17,2250,25,2280,17,2300,26,2330,18];            var shapeColorBig = [[1920,142,41,43],[1925,194,35,47],[1922,249,39,46],[1920,305,44,43]];            var shapeColorSmall = [[1981,150,25,26],[1983,204,21,28],[1982,258,24,28],[1980,313,27,26]];                        return {                "cardbg":{from:[1920,0,73,100], to:[0,0]},                "rankleft":midPoint({from:[txtRankLine[rankIndex*2],txtColorLine[colorIndex],txtRankLine[rankIndex*2+1],34], to:[22,24]}),                "colorcenter":midPoint({from:shapeColorBig[colorIndex], to:[36,70]}),                "colorright":midPoint({from:shapeColorSmall[colorIndex], to:[51,24]}),            };        }    },    "1920x1200":{        "ui":{            "menuMask":[{from:[0,0,1920,1200], to:[0,0]}],            "menuContainer":[{from:[1920,0,192,192], to:[0,0]}],            "menuItemYes":[{from:[1920,196,107,36], to:[0,0]}],            "menuItemNo":[{from:[1920,235,107,36], to:[0,0]}],            "menuItemOk":[{from:[1920,279,72,72], to:[0,0]}],            "menuItemThemeClassic":[{from:[1920,360,250,200], to:[0,0]}],        },        "theme":{            "bg":[{from:[0,0,1920,1200], to:[0,0]}],            "cardplaybg":[{from:[2000,0,73,100], to:[0,0]}],            "cardboardempty":[{from:[2080,0,73,100], to:[0,0]}],            "cardboardyes":[{from:[2160,0,73,100], to:[0,0]}],            "cardboardno":[{from:[2240,0,73,100], to:[0,0]}],            "cardtouched":[{from:[2320,0,73,100], to:[0,0]}],            "newBtn":[{from:[1920,400,72,72], to:[0,0]}],            "retryBtn":[{from:[2008,400,72,72], to:[0,0]}],            "hintBtn":[{from:[2096,400,72,72], to:[0,0]}],            "soundOnBtn":[{from:[2184,400,72,72], to:[0,0]}],            "soundOffBtn":[{from:[2184,490,72,72], to:[0,0]}],            "themeBtn":[{from:[2272,400,72,72], to:[0,0]}],            "undoBtn":[{from:[2360,400,72,72], to:[0,0]}],        },        "card":function(colorIndex, rankIndex) {            var txtColorLine = [146,200,258,312];            var txtRankLine = [2020,22,2048,17,2073,17,2098,19,2124,18,2150,17,2176,17,2202,17,2227,17,2250,25,2280,17,2300,26,2330,18];            var shapeColorBig = [[1920,142,41,43],[1925,194,35,47],[1922,249,39,46],[1920,305,44,43]];            var shapeColorSmall = [[1981,150,25,26],[1983,204,21,28],[1982,258,24,28],[1980,313,27,26]];                        return {                "cardbg":{from:[1920,0,73,100], to:[0,0]},                "rankleft":midPoint({from:[txtRankLine[rankIndex*2],txtColorLine[colorIndex],txtRankLine[rankIndex*2+1],34], to:[22,24]}),                "colorcenter":midPoint({from:shapeColorBig[colorIndex], to:[36,70]}),                "colorright":midPoint({from:shapeColorSmall[colorIndex], to:[51,24]}),            };        }    },};//exportvar exportdirs = [];for(resolution in resolutions){    //push ui    exportdirs.push({        savedir:{"folder":"","file":"ui"},        resolution:resolution,        sprites:resolutions[resolution]["ui"]    });        //push themes    for(theme in themes)    {        //coeur, careau,pique,trefle        var colors = ["D","S","H","C"];        var ranks = ["A","2","3","4","5","6","7","8","9","10","J","Q","K"];        var sprites = null;        if(exportmode == "debug")        {			sprites = resolutions[resolution]["theme"];						for(colorIndex in colors)			{				var color = colors[colorIndex];				for(rankIndex in ranks)				{					var rank = ranks[rankIndex];					var card = resolutions[resolution]["card"](colorIndex, rankIndex);					sprites["card_" + color + rank] = [card["cardbg"],card["rankleft"],card["colorcenter"],card["colorright"]];				}			}        }        else if(exportmode == "texturepacker")        {            sprites = resolutions[resolution]["theme"];                        for(colorIndex in colors)		   {				var color = colors[colorIndex];				for(rankIndex in ranks)				{				    var rank = ranks[rankIndex];				    var card = resolutions[resolution]["card"](colorIndex, rankIndex);				    sprites["cardbg"] = [zeroPoint(card["cardbg"])];				    sprites["big_" + color] = [zeroPoint(card["colorcenter"])];                      sprites["small_" + color] = [zeroPoint(card["colorright"])];                      sprites["rank_" + color  + rank] = [zeroPoint(card["rankleft"])];				}			}        }                exportdirs.push({            savedir:{"folder":"themes","file":"themes/" + themes[theme]},            resolution:resolution,            sprites:sprites        });    }}//exportvar savePng = new PNGSaveOptions();for(exportdir in exportdirs){    var savedir = exportdirs[exportdir]["savedir"];    var resolution = exportdirs[exportdir]["resolution"];    var sprites = exportdirs[exportdir]["sprites"];    //check psd exist    var filepsd = new File(datadir + "/Design/" + resolution + "/" + savedir["file"] + ".psd");    if(!filepsd.exists) continue;    if(exportmode == "release")    {        var saveFolder = new Folder(datadir + "/Export/" + resolution + "/" + savedir["folder"]);        if(!saveFolder.exists) saveFolder.create();        var filepng = new File(datadir + "/Export/" + resolution + "/" + savedir["file"] + ".png");        if(!filepng.exists)        {            var spritePsdDoc = open(filepsd);            spritePsdDoc.mergeVisibleLayers();              spritePsdDoc.saveAs(filepng, savePng, true);            spritePsdDoc.close(SaveOptions.DONOTSAVECHANGES);            spritePsdDoc = null;        }    }    else if(exportmode == "debug")    {        var saveFolder = new Folder(datadir + "/Export/" + resolution + "/" + savedir["file"]);        if(!saveFolder.exists) saveFolder.create();        var filepng = new File(datadir + "/Export/" + resolution + "/" + savedir["file"] + ".png");        if(!filepng.exists)        {            var spritePsdDoc = open(filepsd);            spritePsdDoc.mergeVisibleLayers();            spritePsdDoc.saveAs(filepng, savePng, true);            spritePsdDoc.close(SaveOptions.DONOTSAVECHANGES);            spritePsdDoc = null;        }        var spriteSrcDoc = null;        for(spritename in sprites)        {            var spriteFile = new File(datadir + "/Export/" + resolution + "/" + savedir["file"]  + "/" + spritename + ".png");            if(spriteFile.exists) continue;                        if(!spriteSrcDoc)            {                spriteSrcDoc = open(filepng);            }                var sprite = sprites[spritename];            var size = spriteSize(sprite);                        var spriteDestDoc = app.documents.add(size["width"], size["height"], 72, spritename, NewDocumentMode.RGB, DocumentFill.TRANSPARENT);            spriteCopy(sprite, spriteSrcDoc, spriteDestDoc);            spriteDestDoc.mergeVisibleLayers();            spriteDestDoc.saveAs(spriteFile, savePng, true);            spriteDestDoc.close(SaveOptions.DONOTSAVECHANGES);            spriteDestDoc = null;        }        if(spriteSrcDoc)        {            spriteSrcDoc.close(SaveOptions.DONOTSAVECHANGES);            spriteSrcDoc = null;            filepng = null;        }    }    else if(exportmode == "texturepacker")    {        var saveFolder = new Folder(datadir + "/Export/" + resolution + "/" + savedir["file"]);        if(!saveFolder.exists) saveFolder.create();        var filepng = new File(datadir + "/Export/" + resolution + "/" + savedir["file"] + ".png");        if(!filepng.exists)        {            var spritePsdDoc = open(filepsd);            spritePsdDoc.mergeVisibleLayers();            spritePsdDoc.saveAs(filepng, savePng, true);            spritePsdDoc.close(SaveOptions.DONOTSAVECHANGES);            spritePsdDoc = null;        }        var spriteSrcDoc = null;        for(spritename in sprites)        {            var spriteFile = new File(datadir + "/Export/" + resolution + "/" + savedir["file"]  + "/" + spritename + ".png");            if(spriteFile.exists) continue;                        if(!spriteSrcDoc)            {                spriteSrcDoc = open(filepng);            }                var sprite = sprites[spritename];            var size = spriteSize(sprite);                        var spriteDestDoc = app.documents.add(size["width"], size["height"], 72, spritename, NewDocumentMode.RGB, DocumentFill.TRANSPARENT);            spriteCopy(sprite, spriteSrcDoc, spriteDestDoc);            spriteDestDoc.mergeVisibleLayers();            spriteDestDoc.saveAs(spriteFile, savePng, true);            spriteDestDoc.close(SaveOptions.DONOTSAVECHANGES);            spriteDestDoc = null;        }        if(spriteSrcDoc)        {            spriteSrcDoc.close(SaveOptions.DONOTSAVECHANGES);            spriteSrcDoc = null;            filepng = null;        }    }}
// zoneItright 2002-2007.  Adobe Systems, Incorporated.  All rights reserved.// This script will demonstrate how to load a selection// from a saved alpha channel.// enable double clicking from the Macintosh Finder or the Windows Explorer#target photoshop// in case we double clicked the fileapp.bringToFront();// debug level: 0-2 (0:disable, 1:break on error, 2:break at beginning)//$.level = 2;//debugger; // launch debugger on next linefunction createRect(x, y, width, height){    return new Array(new Array(x,y), new Array(x + width, y), new Array(x + width, y + height), new Array(x, y + height));}function max(a, b){    return a > b ? a : b;}var datadir = "/Users/math/Mathieu/Programmation/Ma\ programmation/ChinesePuzzle/ChinesePuzzle/Common/Bin/Data/";//datasvar exportdirs = [];// uivar sprites = {    "menuContainer":[{from:[0,0,96,96], to:[0,0]}],    "menuItemTheme":[{from:[96,0,58,58], to:[0,0]}],    "menuItemOk":[{from:[96,58,42,42], to:[0,0]}],};exportdirs.push({    savedir:"ui",    resolution:"480x320",    sprites:sprites});// themesvar sprites = {    "bg":[{from:[0,0,480,320], to:[0,0]}],    "bgcard":[{from:[506,0,26,36], to:[0,0]}],    "boardcard":[{from:[532,0,26,36], to:[0,0]}],    "boardcardyes":[{from:[558,0,26,36], to:[0,0]}],    "boardcardno":[{from:[584,0,26,36], to:[0,0]}],    "newBtn":[{from:[480,94,30,30], to:[0,0]}],    "hintBtn":[{from:[510,94,30,30], to:[0,0]}],    "menuBtn":[{from:[540,94,30,30], to:[0,0]}],    "undoBtn":[{from:[570,94,30,30], to:[0,0]}],};var colors = ["C","D","H","S"];var ranks = ["A","2","3","4","5","6","7","8","9","10","J","Q","K"];for(colorIndex in colors){    var color = colors[colorIndex];    for(rankIndex in ranks)    {        var isRed = colorIndex == 1 || colorIndex == 3;        var rank = ranks[rankIndex];        sprites[color + rank] = [            {from:[480,0,26,36], to:[0,0]}, //card bg            {from:[480 + 12 * rankIndex,48 + isRed * 12,12,12], to:[1,1]}, //rank left            {from:[480 + 12 * colorIndex,36,12,12], to:[13,1]}, //color right            {from:[480 + 24 * colorIndex,72,24,22], to:[1,13]}, //color center        ];    }}exportdirs.push({    savedir:"themes/classic",    resolution:"480x320",    sprites:sprites});//exportfor(exportdir in exportdirs){    var savedir = exportdirs[exportdir]["savedir"];    var resolution = exportdirs[exportdir]["resolution"];    var sprites = exportdirs[exportdir]["sprites"];    var savePng = new PNGSaveOptions();    var saveFolder = new Folder(datadir + "/" + savedir + "/" + resolution + "/");    if(!saveFolder.exists) saveFolder.create();         var file = new File(datadir + "/" + savedir + "/" + resolution + ".png");    var spriteSrcDoc = open(file);        for(spritename in sprites)    {        var spriteFile = new File(datadir + "/" + savedir + "/" + resolution + "/" + spritename + ".png");        if(spriteFile.exists) continue;            var sprite = sprites[spritename];            var width = 0;        var height = 0;            for(zoneIt in sprite)        {            var zone = sprite[zoneIt];            width = max(zone["from"][2] + zone["to"][0], width);            height = max(zone["from"][3] + zone["to"][1], height);        }            var spriteDestDoc = app.documents.add(width, height, 72, spritename, NewDocumentMode.RGB, DocumentFill.TRANSPARENT);            for(zoneIt in sprite)        {            var zone = sprite[zoneIt];            app.activeDocument = spriteSrcDoc;            spriteSrcDoc.selection.select(createRect(zone["from"][0],zone["from"][1],zone["from"][2],zone["from"][3]));            spriteSrcDoc.selection.copy();                        app.activeDocument = spriteDestDoc;            spriteDestDoc.selection.select(createRect(zone["to"][0],zone["to"][1],zone["from"][2],zone["from"][3]));            spriteDestDoc.paste(true);        }            spriteDestDoc.mergeVisibleLayers();        spriteDestDoc.saveAs(spriteFile, savePng);        spriteDestDoc.close(SaveOptions.DONOTSAVECHANGES);        spriteDestDoc = null;    }    spriteSrcDoc.close(SaveOptions.DONOTSAVECHANGES);    spriteSrcDoc = null;    file = null;}